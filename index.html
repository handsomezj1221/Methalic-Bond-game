<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Metallic Bond & Electron Sea Game</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
        sans-serif;
      background: radial-gradient(circle at top, #020617 0%, #020617 45%, #000 100%);
      color: #e5e7eb;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 16px;
    }
    .app {
      display: grid;
      grid-template-columns: minmax(260px, 320px) minmax(500px, 840px);
      gap: 16px;
      width: 100%;
      max-width: 1180px;
    }
    .panel {
      background: rgba(15, 23, 42, 0.96);
      border-radius: 18px;
      border: 1px solid rgba(148, 163, 184, 0.4);
      box-shadow: 0 20px 45px rgba(0, 0, 0, 0.7);
      padding: 18px 18px 16px;
    }
    .panel-header {
      margin-bottom: 10px;
    }
    .title {
      font-size: 20px;
      font-weight: 700;
      letter-spacing: 0.03em;
      margin-bottom: 4px;
    }
    .subtitle {
      font-size: 13px;
      color: #9ca3af;
    }
    .badge-row {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      margin-top: 10px;
    }
    .badge {
      font-size: 11px;
      padding: 4px 8px;
      border-radius: 999px;
      border: 1px solid rgba(96, 165, 250, 0.7);
      background: radial-gradient(circle at top, rgba(59, 130, 246, 0.35), transparent);
      color: #bfdbfe;
      white-space: nowrap;
    }
    .section {
      margin-top: 12px;
      padding-top: 10px;
      border-top: 1px solid rgba(31, 41, 55, 0.9);
    }
    .section-title {
      font-size: 13px;
      font-weight: 600;
      margin-bottom: 6px;
      color: #e5e7eb;
    }
    .section-body {
      font-size: 12px;
      color: #9ca3af;
      line-height: 1.5;
    }
    .goal-box {
      margin-top: 6px;
      padding: 8px 10px;
      border-radius: 10px;
      background: linear-gradient(135deg, rgba(34, 197, 94, 0.12), rgba(37, 99, 235, 0.12));
      border: 1px solid rgba(52, 211, 153, 0.3);
      font-size: 12px;
      color: #bbf7d0;
    }
    .mode-box {
      margin-top: 6px;
      padding: 8px 10px;
      border-radius: 10px;
      background: rgba(15, 23, 42, 0.9);
      border: 1px solid rgba(55, 65, 81, 0.9);
      font-size: 12px;
      color: #e5e7eb;
    }
    .mode-label {
      font-size: 11px;
      text-transform: uppercase;
      letter-spacing: 0.12em;
      color: #9ca3af;
    }
    .mode-name {
      font-weight: 600;
      margin-top: 2px;
    }
    .mode-desc {
      font-size: 11px;
      color: #9ca3af;
      margin-top: 2px;
    }
    .lang-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-top: 10px;
      gap: 10px;
      flex-wrap: wrap;
    }
    .lang-buttons {
      display: inline-flex;
      background: rgba(15, 23, 42, 0.9);
      border-radius: 999px;
      border: 1px solid rgba(55, 65, 81, 0.9);
      overflow: hidden;
    }
    .lang-btn {
      font-size: 11px;
      padding: 4px 10px;
      border: none;
      background: transparent;
      color: #9ca3af;
      cursor: pointer;
    }
    .lang-btn.active {
      background: rgba(37, 99, 235, 0.9);
      color: #e5e7eb;
    }
    .small-label {
      font-size: 11px;
      color: #6b7280;
    }

    /* GAME PANEL */
    canvas {
      display: block;
      width: 100%;
      max-width: 820px;
      height: auto;
      border-radius: 14px;
      border: 1px solid rgba(55, 65, 81, 0.8);
      background: radial-gradient(circle at center, #020617 0%, #020617 55%, #000 100%);
    }
    .game-header-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      margin-bottom: 10px;
      flex-wrap: wrap;
    }
    .game-title {
      font-size: 16px;
      font-weight: 600;
    }
    .game-subtitle {
      font-size: 12px;
      color: #9ca3af;
    }
    .pill {
      font-size: 11px;
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid rgba(96, 165, 250, 0.7);
      color: #bfdbfe;
      background: radial-gradient(circle at top, rgba(59, 130, 246, 0.35), transparent);
      white-space: nowrap;
    }
    .game-footer-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-top: 8px;
      font-size: 12px;
      color: #e5e7eb;
      gap: 10px;
      flex-wrap: wrap;
    }
    .controls span {
      padding: 2px 6px;
      border-radius: 6px;
      background: rgba(31, 41, 55, 0.95);
      border: 1px solid rgba(75, 85, 99, 0.9);
      margin-right: 4px;
      font-size: 11px;
    }
    .bar-container {
      flex: 1;
      min-width: 160px;
      background: rgba(15, 23, 42, 0.95);
      border-radius: 999px;
      overflow: hidden;
      border: 1px solid rgba(55, 65, 81, 0.9);
      height: 14px;
    }
    .bar-fill {
      height: 100%;
      background: linear-gradient(90deg, #22c55e, #eab308, #ef4444);
      width: 100%;
      transform-origin: left center;
    }
    .status-text {
      font-size: 11px;
      color: #9ca3af;
      margin-left: 6px;
      white-space: nowrap;
    }

    @media (max-width: 900px) {
      .app {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>
<body>
<div class="app">
  <!-- 左边：说明 / 目标 / 模式 / 语言 -->
  <aside class="panel">
    <div class="panel-header">
      <div class="title" id="side-title">Metallic Bond & Electron Sea Game</div>
      <div class="subtitle" id="side-subtitle">
        Explore how delocalised electrons move through a metallic lattice.
      </div>
      <div class="badge-row">
        <div class="badge" id="badge-topic">Topic: Metallic Bond</div>
        <div class="badge" id="badge-subtopic">Electron Sea Model · Conductivity · Malleability</div>
      </div>
    </div>

    <div class="section">
      <div class="section-title" id="goal-title">Current Goal</div>
      <div class="goal-box" id="goal-text">
        Guide the free electron from the negative terminal to the positive terminal without losing too much lattice stability.
      </div>
    </div>

    <div class="section">
      <div class="section-title" id="lo-title">Learning Outcomes</div>
      <div class="section-body" id="lo-text">
        • Visualise the metallic bond as a lattice of positive metal cations surrounded by a sea of delocalised electrons.<br/>
        • Explain how free electrons allow metals to conduct electricity.<br/>
        • Relate collisions and disturbances in the lattice to reduced stability and conductivity.
      </div>
    </div>

    <div class="section">
      <div class="section-title" id="mode-section-title">Mode</div>
      <div class="mode-box">
        <div class="mode-label" id="mode-label">ACTIVE MODE</div>
        <div class="mode-name" id="mode-name">Free Flow</div>
        <div class="mode-desc" id="mode-desc">
          Move the electron freely through the metallic lattice. Avoid strong collisions with metal cations to keep the lattice stable.
        </div>
      </div>
    </div>

    <div class="section">
      <div class="lang-row">
        <div>
          <div class="section-title" id="lang-title">Language</div>
          <div class="small-label" id="lang-note">Switch between English and Chinese descriptions.</div>
        </div>
        <div class="lang-buttons">
          <button class="lang-btn active" data-lang="en" id="btn-en">EN</button>
          <button class="lang-btn" data-lang="zh" id="btn-zh">中文</button>
        </div>
      </div>
    </div>
  </aside>

  <!-- 右边：游戏画面 -->
  <main class="panel">
    <div class="game-header-row">
      <div>
        <div class="game-title" id="game-title">Electron Sea Defense</div>
        <div class="game-subtitle" id="game-subtitle">
          You are a delocalised electron moving through a metallic lattice.
        </div>
      </div>
      <div class="pill" id="pill-topic">
        Metallic Bond · Interactive Simulation
      </div>
    </div>

    <canvas id="gameCanvas" width="820" height="460"></canvas>

    <div class="game-footer-row">
      <div class="controls" id="controls-text">
        <span>↑</span><span>↓</span><span>←</span><span>→</span> move
        <span>Space</span> start
        <span>R</span> restart
      </div>
      <div style="display:flex;align-items:center;gap:4px;flex:1;justify-content:flex-end;">
        <div class="bar-container">
          <div id="stabilityBar" class="bar-fill"></div>
        </div>
        <div id="statusText" class="status-text">Lattice stability: 100%</div>
      </div>
    </div>
  </main>
</div>

<script>
  // ====== LANGUAGE TOGGLE ======
  const langTexts = {
    en: {
      sideTitle: "Metallic Bond & Electron Sea Game",
      sideSubtitle: "Explore how delocalised electrons move through a metallic lattice.",
      badgeTopic: "Topic: Metallic Bond",
      badgeSubtopic: "Electron Sea Model · Conductivity · Malleability",
      goalTitle: "Current Goal",
      goalText:
        "Guide the free electron from the negative terminal to the positive terminal without losing too much lattice stability.",
      loTitle: "Learning Outcomes",
      loText:
        "• Visualise the metallic bond as a lattice of positive metal cations surrounded by a sea of delocalised electrons.<br/>" +
        "• Explain how free electrons allow metals to conduct electricity.<br/>" +
        "• Relate collisions and disturbances in the lattice to reduced stability and conductivity.",
      modeSectionTitle: "Mode",
      modeLabel: "ACTIVE MODE",
      modeName: "Free Flow",
      modeDesc:
        "Move the electron freely through the metallic lattice. Avoid strong collisions with metal cations to keep the lattice stable.",
      langTitle: "Language",
      langNote: "Switch between English and Chinese descriptions.",
      gameTitle: "Electron Sea Defense",
      gameSubtitle: "You are a delocalised electron moving through a metallic lattice.",
      pillTopic: "Metallic Bond · Interactive Simulation",
      controlsText:
        "<span>↑</span><span>↓</span><span>←</span><span>→</span> move <span>Space</span> start <span>R</span> restart",
    },
    zh: {
      sideTitle: "金属键与电子海互动游戏",
      sideSubtitle: "观察离域电子在金属阳离子晶格中的运动方式。",
      badgeTopic: "主题：Metallic Bond（金属键）",
      badgeSubtopic: "电子海模型 · 导电性 · 延展性",
      goalTitle: "目前目标",
      goalText:
        "控制这颗自由电子，从左侧负极移动到右侧正极，并尽量保持金属晶格的稳定度不要过低。",
      loTitle: "学习成果（Learning Outcomes）",
      loText:
        "• 将金属键想像成：一排排带正电的金属阳离子，被一片离域电子海包围。<br/>" +
        "• 说明为什么自由电子可以让金属导电。<br/>" +
        "• 把“碰撞、扰动”与金属晶格稳定度下降、导电性降低连起来理解。",
      modeSectionTitle: "模式",
      modeLabel: "互动模式",
      modeName: "自由流动（Free Flow）",
      modeDesc:
        "在金属晶格中自由移动电子，尽量避免与金属阳离子强烈碰撞，以保持金属键的稳定。",
      langTitle: "语言",
      langNote: "在英文与中文说明之间切换。",
      gameTitle: "电子海守卫战（Electron Sea Defense）",
      gameSubtitle: "你是一颗在金属晶格中移动的离域电子。",
      pillTopic: "金属键 · 互动模拟",
      controlsText:
        "<span>↑</span><span>↓</span><span>←</span><span>→</span> 移动 <span>Space</span> 开始 <span>R</span> 重来",
    },
  };

  const langBtns = document.querySelectorAll(".lang-btn");
  const elems = {
    sideTitle: document.getElementById("side-title"),
    sideSubtitle: document.getElementById("side-subtitle"),
    badgeTopic: document.getElementById("badge-topic"),
    badgeSubtopic: document.getElementById("badge-subtopic"),
    goalTitle: document.getElementById("goal-title"),
    goalText: document.getElementById("goal-text"),
    loTitle: document.getElementById("lo-title"),
    loText: document.getElementById("lo-text"),
    modeSectionTitle: document.getElementById("mode-section-title"),
    modeLabel: document.getElementById("mode-label"),
    modeName: document.getElementById("mode-name"),
    modeDesc: document.getElementById("mode-desc"),
    langTitle: document.getElementById("lang-title"),
    langNote: document.getElementById("lang-note"),
    gameTitle: document.getElementById("game-title"),
    gameSubtitle: document.getElementById("game-subtitle"),
    pillTopic: document.getElementById("pill-topic"),
    controlsText: document.getElementById("controls-text"),
  };

  function setLanguage(lang) {
    const t = langTexts[lang];
    elems.sideTitle.textContent = t.sideTitle;
    elems.sideSubtitle.textContent = t.sideSubtitle;
    elems.badgeTopic.textContent = t.badgeTopic;
    elems.badgeSubtopic.textContent = t.badgeSubtopic;
    elems.goalTitle.textContent = t.goalTitle;
    elems.goalText.innerHTML = t.goalText;
    elems.loTitle.textContent = t.loTitle;
    elems.loText.innerHTML = t.loText;
    elems.modeSectionTitle.textContent = t.modeSectionTitle;
    elems.modeLabel.textContent = t.modeLabel;
    elems.modeName.textContent = t.modeName;
    elems.modeDesc.textContent = t.modeDesc;
    elems.langTitle.textContent = t.langTitle;
    elems.langNote.textContent = t.langNote;
    elems.gameTitle.textContent = t.gameTitle;
    elems.gameSubtitle.textContent = t.gameSubtitle;
    elems.pillTopic.textContent = t.pillTopic;
    elems.controlsText.innerHTML = t.controlsText;

    langBtns.forEach((btn) => {
      btn.classList.toggle("active", btn.dataset.lang === lang);
    });
  }

  langBtns.forEach((btn) => {
    btn.addEventListener("click", () => setLanguage(btn.dataset.lang));
  });

  // 默认英文
  setLanguage("en");

  // ====== GAME CODE（和之前的 Electron Sea Defense 相同核心） ======
  const canvas = document.getElementById("gameCanvas");
  const ctx = canvas.getContext("2d");

  const keys = {};
  window.addEventListener("keydown", (e) => {
    keys[e.key.toLowerCase()] = true;
    if (e.key === " ") e.preventDefault();
  });
  window.addEventListener("keyup", (e) => {
    keys[e.key.toLowerCase()] = false;
  });

  const WIDTH = canvas.width;
  const HEIGHT = canvas.height;

  const player = {
    x: 80,
    y: HEIGHT / 2,
    r: 10,
    speed: 210,
  };

  const ions = [];
  const ionRadius = 12;
  const leftMargin = 150;
  const rightMargin = WIDTH - 80;
  const topMargin = 80;
  const bottomMargin = HEIGHT - 80;
  const xStep = 80;
  const yStep = 80;

  for (let x = leftMargin; x <= rightMargin; x += xStep) {
    for (let y = topMargin; y <= bottomMargin; y += yStep) {
      ions.push({ x, y, r: ionRadius });
    }
  }

  const freeElectrons = [];
  for (let i = 0; i < 40; i++) {
    freeElectrons.push({
      x: leftMargin + Math.random() * (rightMargin - leftMargin),
      y: topMargin + Math.random() * (bottomMargin - topMargin),
      r: 3,
      vx: (Math.random() - 0.5) * 40,
      vy: (Math.random() - 0.5) * 40,
    });
  }

  let stability = 100;
  let gameStarted = false;
  let gameOver = false;
  let win = false;
  let lastTime = null;

  const stabilityBar = document.getElementById("stabilityBar");
  const statusText = document.getElementById("statusText");

  function resetGame() {
    player.x = 80;
    player.y = HEIGHT / 2;
    stability = 100;
    gameStarted = false;
    gameOver = false;
    win = false;
    lastTime = null;
    stabilityBar.style.transform = "scaleX(1)";
    statusText.textContent = "Lattice stability: 100%";
  }

  function update(dt) {
    freeElectrons.forEach((e) => {
      e.x += e.vx * dt;
      e.y += e.vy * dt;
      if (e.x < leftMargin || e.x > rightMargin) e.vx *= -1;
      if (e.y < topMargin || e.y > bottomMargin) e.vy *= -1;
    });

    if (!gameStarted || gameOver) return;

    let vx = 0,
      vy = 0;
    if (keys["arrowup"] || keys["w"]) vy -= 1;
    if (keys["arrowdown"] || keys["s"]) vy += 1;
    if (keys["arrowleft"] || keys["a"]) vx -= 1;
    if (keys["arrowright"] || keys["d"]) vx += 1;

    if (vx !== 0 || vy !== 0) {
      const len = Math.hypot(vx, vy);
      vx /= len;
      vy /= len;
    }

    player.x += vx * player.speed * dt;
    player.y += vy * player.speed * dt;

    player.x = Math.max(40, Math.min(WIDTH - 40, player.x));
    player.y = Math.max(40, Math.min(HEIGHT - 40, player.y));

    ions.forEach((ion) => {
      const dx = player.x - ion.x;
      const dy = player.y - ion.y;
      const dist = Math.hypot(dx, dy);
      const minDist = player.r + ion.r + 1;
      if (dist < minDist) {
        const nx = dx / (dist || 1);
        const ny = dy / (dist || 1);
        player.x = ion.x + nx * minDist;
        player.y = ion.y + ny * minDist;
        stability -= 18 * dt * 60;
      }
    });

    if (vx > 0.4) {
      stability += 8 * dt * 60;
    }

    stability -= 2 * dt * 60 * 0.02;
    stability = Math.max(0, Math.min(100, stability));

    if (player.x > WIDTH - 70) {
      gameOver = true;
      win = true;
    }
    if (stability <= 0) {
      gameOver = true;
      win = false;
    }

    stabilityBar.style.transform = `scaleX(${stability / 100})`;
    statusText.textContent = `Lattice stability: ${stability.toFixed(0)}%`;
  }

  function drawLatticeBackground() {
    const grad = ctx.createLinearGradient(0, 0, WIDTH, HEIGHT);
    grad.addColorStop(0, "#020617");
    grad.addColorStop(1, "#020617");
    ctx.fillStyle = grad;
    ctx.fillRect(0, 0, WIDTH, HEIGHT);

    ctx.fillStyle = "#1e293b";
    ctx.fillRect(40, 40, 20, HEIGHT - 80);
    ctx.fillRect(WIDTH - 60, 40, 20, HEIGHT - 80);

    ctx.fillStyle = "#e5e7eb";
    ctx.font = "11px system-ui";
    ctx.textAlign = "left";
    ctx.fillText("Negative terminal (source of electrons)", 50, 35);
    ctx.textAlign = "right";
    ctx.fillText("Positive terminal (electrons collected)", WIDTH - 70, 35);
    ctx.textAlign = "left";

    ctx.strokeStyle = "#facc15";
    ctx.lineWidth = 2;
    for (let x = 90; x < WIDTH - 90; x += 80) {
      ctx.beginPath();
      ctx.moveTo(x, HEIGHT - 40);
      ctx.lineTo(x + 40, HEIGHT - 40);
      ctx.stroke();
      ctx.beginPath();
      ctx.moveTo(x + 40, HEIGHT - 45);
      ctx.lineTo(x + 40, HEIGHT - 35);
      ctx.lineTo(x + 48, HEIGHT - 40);
      ctx.closePath();
      ctx.fillStyle = "#facc15";
      ctx.fill();
    }
    ctx.fillStyle = "#facc15";
    ctx.fillText("Direction of electron flow", 90, HEIGHT - 20);
  }

  function draw() {
    drawLatticeBackground();

    ions.forEach((ion) => {
      const radial = ctx.createRadialGradient(
        ion.x - 4,
        ion.y - 4,
        4,
        ion.x,
        ion.y,
        ion.r + 4
      );
      radial.addColorStop(0, "#e5e7eb");
      radial.addColorStop(1, "#4b5563");
      ctx.fillStyle = radial;
      ctx.beginPath();
      ctx.arc(ion.x, ion.y, ion.r, 0, Math.PI * 2);
      ctx.fill();
    });

    freeElectrons.forEach((e) => {
      ctx.fillStyle = "rgba(56, 189, 248, 0.7)";
      ctx.beginPath();
      ctx.arc(e.x, e.y, e.r, 0, Math.PI * 2);
      ctx.fill();
    });

    const pGrad = ctx.createRadialGradient(
      player.x - 3,
      player.y - 3,
      2,
      player.x,
      player.y,
      player.r + 3
    );
    pGrad.addColorStop(0, "#e0f2fe");
    pGrad.addColorStop(1, "#0ea5e9");
    ctx.fillStyle = pGrad;
    ctx.beginPath();
    ctx.arc(player.x, player.y, player.r, 0, Math.PI * 2);
    ctx.fill();
    ctx.strokeStyle = "#0f172a";
    ctx.lineWidth = 1.4;
    ctx.stroke();

    ctx.fillStyle = "#9ca3af";
    ctx.font = "12px system-ui";
    ctx.textAlign = "left";
    ctx.fillText(
      "Avoid colliding with metal cations to keep the metallic bond stable.",
      54,
      60
    );
    ctx.fillText(
      "Move mainly towards the right to follow the direction of electron flow.",
      54,
      76
    );

    if (!gameStarted && !gameOver) {
      ctx.fillStyle = "rgba(15,23,42,0.88)";
      ctx.fillRect(130, 120, WIDTH - 260, 220);
      ctx.strokeStyle = "rgba(148,163,184,0.8)";
      ctx.lineWidth = 1;
      ctx.strokeRect(130.5, 120.5, WIDTH - 261, 219);

      ctx.fillStyle = "#e5e7eb";
      ctx.font = "20px system-ui";
      ctx.textAlign = "center";
      ctx.fillText("Electron Sea Defense", WIDTH / 2, 160);

      ctx.font = "13px system-ui";
      ctx.fillStyle = "#cbd5f5";
      ctx.fillText(
        "Move the free electron from the negative terminal to the positive terminal.",
        WIDTH / 2,
        190
      );
      ctx.fillText(
        "This represents electrons flowing through a metallic bond.",
        WIDTH / 2,
        210
      );

      ctx.fillStyle = "#94a3b8";
      ctx.fillText(
        "Avoid hitting the metal cations (grey spheres). Collisions weaken the lattice stability.",
        WIDTH / 2,
        240
      );
      ctx.fillText(
        "Move mainly to the right to follow the direction of electron flow.",
        WIDTH / 2,
        260
      );

      ctx.fillStyle = "#bfdbfe";
      ctx.font = "14px system-ui";
      ctx.fillText("Press SPACE to start • Press R to restart", WIDTH / 2, 295);
      ctx.textAlign = "left";
    }

    if (gameOver) {
      ctx.fillStyle = "rgba(15,23,42,0.9)";
      ctx.fillRect(150, 150, WIDTH - 300, 180);
      ctx.strokeStyle = "rgba(148,163,184,0.9)";
      ctx.lineWidth = 1.2;
      ctx.strokeRect(150.5, 150.5, WIDTH - 301, 179);

      ctx.textAlign = "center";
      ctx.font = "22px system-ui";
      ctx.fillStyle = win ? "#bbf7d0" : "#fecaca";
      ctx.fillText(
        win
          ? "Current successfully passed through the metal!"
          : "Metallic lattice became unstable!",
        WIDTH / 2,
        190
      );

      ctx.font = "14px system-ui";
      ctx.fillStyle = "#e5e7eb";
      if (win) {
        ctx.fillText(
          "You guided the delocalised electron across the metallic lattice.",
          WIDTH / 2,
          220
        );
        ctx.fillText(
          "This shows how electrons move freely in the electron sea model.",
          WIDTH / 2,
          240
        );
      } else {
        ctx.fillText(
          "Too many strong collisions with metal cations weakened the metallic bond.",
          WIDTH / 2,
          220
        );
        ctx.fillText(
          "In reality, frequent disturbances reduce conductivity and can damage the lattice.",
          WIDTH / 2,
          240
        );
      }

      ctx.fillStyle = "#bfdbfe";
      ctx.fillText("Press R to play again", WIDTH / 2, 270);
      ctx.textAlign = "left";
    }
  }

  function loop(timestamp) {
    if (!lastTime) lastTime = timestamp;
    const dt = (timestamp - lastTime) / 1000;
    lastTime = timestamp;
    update(dt);
    draw();
    requestAnimationFrame(loop);
  }

  window.addEventListener("keydown", (e) => {
    if (e.key === " " && !gameStarted && !gameOver) {
      gameStarted = true;
    }
    if (e.key.toLowerCase() === "r") {
      resetGame();
    }
  });

  resetGame();
  requestAnimationFrame(loop);
</script>
</body>
</html>